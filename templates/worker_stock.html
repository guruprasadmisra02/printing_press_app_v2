{% extends 'base.html' %}
{% block content %}

<div class="d-flex justify-content-between align-items-center">
  <h4>Stock Management (Worker)</h4>
</div>

<!-- ✅ Add or Update Stock -->
<div class="mt-3">
  <form method="post" class="row g-3 align-items-end border p-3 rounded bg-light shadow-sm">
    <input type="hidden" name="action" value="add_stock">
    <div class="col-md-3">
      <label class="form-label">Item Name</label>
      <input type="text" name="item_name" class="form-control" required>
    </div>
    <div class="col-md-2">
      <label class="form-label">Item No</label>
      <input type="text" name="item_no" class="form-control">
    </div>
    <div class="col-md-2">
      <label class="form-label">Size</label>
      <input type="text" name="size" class="form-control">
    </div>
    <div class="col-md-2">
      <label class="form-label">Add Qty</label>
      <input type="number" step="0.01" min="0.01" name="added_quantity" class="form-control" required>
    </div>
    <div class="col-md-2">
      <label class="form-label">Total Cost (₹)</label>
      <input type="number" step="0.01" min="0" name="addition_total_cost" class="form-control" required>
    </div>
    <div class="col-md-1">
      <button class="btn btn-primary w-100">Add</button>
    </div>
  </form>
</div>

<hr>

<!-- ✅ Stock Table -->
<div class="table-responsive mt-3">
  <table class="table table-striped table-hover align-middle">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Item Name</th>
        <th>Item No</th>
        <th>Size</th>
        <th>Quantity</th>
        <th>Unit Cost (₹)</th>
        <th>Total Amount (₹)</th>
        <th>Last Updated</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for item in stock %}
      <tr>
        <td>{{ item.id }}</td>
        <td>{{ item.item_name }}</td>
        <td>{{ item.item_no or '-' }}</td>
        <td>{{ item.size or '-' }}</td>
        <td>{{ '%.2f'|format(item.quantity) }}</td>
        <td>{{ '%.2f'|format(item.unit_cost) }}</td>
        <td>{{ '%.2f'|format(item.total_amount) }}</td>
        <td>{{ item.last_updated or '-' }}</td>
        <td>
          {% if item.used %}
            <span class="badge bg-secondary">Used</span>
          {% else %}
            <span class="badge bg-success">Available</span>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="9" class="text-center text-muted">No stock items found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
